{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n    m = s && o[s],\n    i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CommonMtableMixin = void 0;\nvar BBox_js_1 = require(\"../../../util/BBox.js\");\nvar string_js_1 = require(\"../../../util/string.js\");\nvar numeric_js_1 = require(\"../../../util/numeric.js\");\nfunction CommonMtableMixin(Base) {\n  return function (_super) {\n    __extends(class_1, _super);\n    function class_1() {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      var _this = _super.apply(this, __spreadArray([], __read(args), false)) || this;\n      _this.numCols = 0;\n      _this.numRows = 0;\n      _this.data = null;\n      _this.pwidthCells = [];\n      _this.pWidth = 0;\n      _this.numCols = (0, numeric_js_1.max)(_this.tableRows.map(function (row) {\n        return row.numCells;\n      }));\n      _this.numRows = _this.childNodes.length;\n      _this.hasLabels = _this.childNodes.reduce(function (value, row) {\n        return value || row.node.isKind('mlabeledtr');\n      }, false);\n      _this.findContainer();\n      _this.isTop = !_this.container || _this.container.node.isKind('math') && !_this.container.parent;\n      if (_this.isTop) {\n        _this.jax.table = _this;\n      }\n      _this.getPercentageWidth();\n      var attributes = _this.node.attributes;\n      _this.frame = attributes.get('frame') !== 'none';\n      _this.fLine = _this.frame && attributes.get('frame') ? .07 : 0;\n      _this.fSpace = _this.frame ? _this.convertLengths(_this.getAttributeArray('framespacing')) : [0, 0];\n      _this.cSpace = _this.convertLengths(_this.getColumnAttributes('columnspacing'));\n      _this.rSpace = _this.convertLengths(_this.getRowAttributes('rowspacing'));\n      _this.cLines = _this.getColumnAttributes('columnlines').map(function (x) {\n        return x === 'none' ? 0 : .07;\n      });\n      _this.rLines = _this.getRowAttributes('rowlines').map(function (x) {\n        return x === 'none' ? 0 : .07;\n      });\n      _this.cWidths = _this.getColumnWidths();\n      _this.stretchRows();\n      _this.stretchColumns();\n      return _this;\n    }\n    Object.defineProperty(class_1.prototype, \"tableRows\", {\n      get: function () {\n        return this.childNodes;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    class_1.prototype.findContainer = function () {\n      var node = this;\n      var parent = node.parent;\n      while (parent && (parent.node.notParent || parent.node.isKind('mrow'))) {\n        node = parent;\n        parent = parent.parent;\n      }\n      this.container = parent;\n      this.containerI = node.node.childPosition();\n    };\n    class_1.prototype.getPercentageWidth = function () {\n      if (this.hasLabels) {\n        this.bbox.pwidth = BBox_js_1.BBox.fullWidth;\n      } else {\n        var width = this.node.attributes.get('width');\n        if ((0, string_js_1.isPercent)(width)) {\n          this.bbox.pwidth = width;\n        }\n      }\n    };\n    class_1.prototype.stretchRows = function () {\n      var equal = this.node.attributes.get('equalrows');\n      var HD = equal ? this.getEqualRowHeight() : 0;\n      var _a = equal ? this.getTableData() : {\n          H: [0],\n          D: [0]\n        },\n        H = _a.H,\n        D = _a.D;\n      var rows = this.tableRows;\n      for (var i = 0; i < this.numRows; i++) {\n        var hd = equal ? [(HD + H[i] - D[i]) / 2, (HD - H[i] + D[i]) / 2] : null;\n        rows[i].stretchChildren(hd);\n      }\n    };\n    class_1.prototype.stretchColumns = function () {\n      for (var i = 0; i < this.numCols; i++) {\n        var width = typeof this.cWidths[i] === 'number' ? this.cWidths[i] : null;\n        this.stretchColumn(i, width);\n      }\n    };\n    class_1.prototype.stretchColumn = function (i, W) {\n      var e_1, _a, e_2, _b, e_3, _c;\n      var stretchy = [];\n      try {\n        for (var _d = __values(this.tableRows), _e = _d.next(); !_e.done; _e = _d.next()) {\n          var row = _e.value;\n          var cell = row.getChild(i);\n          if (cell) {\n            var child = cell.childNodes[0];\n            if (child.stretch.dir === 0 && child.canStretch(2)) {\n              stretchy.push(child);\n            }\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_e && !_e.done && (_a = _d.return)) _a.call(_d);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n      var count = stretchy.length;\n      var nodeCount = this.childNodes.length;\n      if (count && nodeCount > 1) {\n        if (W === null) {\n          W = 0;\n          var all = count > 1 && count === nodeCount;\n          try {\n            for (var _f = __values(this.tableRows), _g = _f.next(); !_g.done; _g = _f.next()) {\n              var row = _g.value;\n              var cell = row.getChild(i);\n              if (cell) {\n                var child = cell.childNodes[0];\n                var noStretch = child.stretch.dir === 0;\n                if (all || noStretch) {\n                  var w = child.getBBox(noStretch).w;\n                  if (w > W) {\n                    W = w;\n                  }\n                }\n              }\n            }\n          } catch (e_2_1) {\n            e_2 = {\n              error: e_2_1\n            };\n          } finally {\n            try {\n              if (_g && !_g.done && (_b = _f.return)) _b.call(_f);\n            } finally {\n              if (e_2) throw e_2.error;\n            }\n          }\n        }\n        try {\n          for (var stretchy_1 = __values(stretchy), stretchy_1_1 = stretchy_1.next(); !stretchy_1_1.done; stretchy_1_1 = stretchy_1.next()) {\n            var child = stretchy_1_1.value;\n            child.coreMO().getStretchedVariant([W]);\n          }\n        } catch (e_3_1) {\n          e_3 = {\n            error: e_3_1\n          };\n        } finally {\n          try {\n            if (stretchy_1_1 && !stretchy_1_1.done && (_c = stretchy_1.return)) _c.call(stretchy_1);\n          } finally {\n            if (e_3) throw e_3.error;\n          }\n        }\n      }\n    };\n    class_1.prototype.getTableData = function () {\n      if (this.data) {\n        return this.data;\n      }\n      var H = new Array(this.numRows).fill(0);\n      var D = new Array(this.numRows).fill(0);\n      var W = new Array(this.numCols).fill(0);\n      var NH = new Array(this.numRows);\n      var ND = new Array(this.numRows);\n      var LW = [0];\n      var rows = this.tableRows;\n      for (var j = 0; j < rows.length; j++) {\n        var M = 0;\n        var row = rows[j];\n        var align = row.node.attributes.get('rowalign');\n        for (var i = 0; i < row.numCells; i++) {\n          var cell = row.getChild(i);\n          M = this.updateHDW(cell, i, j, align, H, D, W, M);\n          this.recordPWidthCell(cell, i);\n        }\n        NH[j] = H[j];\n        ND[j] = D[j];\n        if (row.labeled) {\n          M = this.updateHDW(row.childNodes[0], 0, j, align, H, D, LW, M);\n        }\n        this.extendHD(j, H, D, M);\n        this.extendHD(j, NH, ND, M);\n      }\n      var L = LW[0];\n      this.data = {\n        H: H,\n        D: D,\n        W: W,\n        NH: NH,\n        ND: ND,\n        L: L\n      };\n      return this.data;\n    };\n    class_1.prototype.updateHDW = function (cell, i, j, align, H, D, W, M) {\n      var _a = cell.getBBox(),\n        h = _a.h,\n        d = _a.d,\n        w = _a.w;\n      var scale = cell.parent.bbox.rscale;\n      if (cell.parent.bbox.rscale !== 1) {\n        h *= scale;\n        d *= scale;\n        w *= scale;\n      }\n      if (this.node.getProperty('useHeight')) {\n        if (h < .75) h = .75;\n        if (d < .25) d = .25;\n      }\n      var m = 0;\n      align = cell.node.attributes.get('rowalign') || align;\n      if (align !== 'baseline' && align !== 'axis') {\n        m = h + d;\n        h = d = 0;\n      }\n      if (h > H[j]) H[j] = h;\n      if (d > D[j]) D[j] = d;\n      if (m > M) M = m;\n      if (W && w > W[i]) W[i] = w;\n      return M;\n    };\n    class_1.prototype.extendHD = function (i, H, D, M) {\n      var d = (M - (H[i] + D[i])) / 2;\n      if (d < .00001) return;\n      H[i] += d;\n      D[i] += d;\n    };\n    class_1.prototype.recordPWidthCell = function (cell, i) {\n      if (cell.childNodes[0] && cell.childNodes[0].getBBox().pwidth) {\n        this.pwidthCells.push([cell, i]);\n      }\n    };\n    class_1.prototype.computeBBox = function (bbox, _recompute) {\n      if (_recompute === void 0) {\n        _recompute = false;\n      }\n      var _a = this.getTableData(),\n        H = _a.H,\n        D = _a.D;\n      var height, width;\n      if (this.node.attributes.get('equalrows')) {\n        var HD = this.getEqualRowHeight();\n        height = (0, numeric_js_1.sum)([].concat(this.rLines, this.rSpace)) + HD * this.numRows;\n      } else {\n        height = (0, numeric_js_1.sum)(H.concat(D, this.rLines, this.rSpace));\n      }\n      height += 2 * (this.fLine + this.fSpace[1]);\n      var CW = this.getComputedWidths();\n      width = (0, numeric_js_1.sum)(CW.concat(this.cLines, this.cSpace)) + 2 * (this.fLine + this.fSpace[0]);\n      var w = this.node.attributes.get('width');\n      if (w !== 'auto') {\n        width = Math.max(this.length2em(w, 0) + 2 * this.fLine, width);\n      }\n      var _b = __read(this.getBBoxHD(height), 2),\n        h = _b[0],\n        d = _b[1];\n      bbox.h = h;\n      bbox.d = d;\n      bbox.w = width;\n      var _c = __read(this.getBBoxLR(), 2),\n        L = _c[0],\n        R = _c[1];\n      bbox.L = L;\n      bbox.R = R;\n      if (!(0, string_js_1.isPercent)(w)) {\n        this.setColumnPWidths();\n      }\n    };\n    class_1.prototype.setChildPWidths = function (_recompute, cwidth, _clear) {\n      var width = this.node.attributes.get('width');\n      if (!(0, string_js_1.isPercent)(width)) return false;\n      if (!this.hasLabels) {\n        this.bbox.pwidth = '';\n        this.container.bbox.pwidth = '';\n      }\n      var _a = this.bbox,\n        w = _a.w,\n        L = _a.L,\n        R = _a.R;\n      var labelInWidth = this.node.attributes.get('data-width-includes-label');\n      var W = Math.max(w, this.length2em(width, Math.max(cwidth, L + w + R))) - (labelInWidth ? L + R : 0);\n      var cols = this.node.attributes.get('equalcolumns') ? Array(this.numCols).fill(this.percent(1 / Math.max(1, this.numCols))) : this.getColumnAttributes('columnwidth', 0);\n      this.cWidths = this.getColumnWidthsFixed(cols, W);\n      var CW = this.getComputedWidths();\n      this.pWidth = (0, numeric_js_1.sum)(CW.concat(this.cLines, this.cSpace)) + 2 * (this.fLine + this.fSpace[0]);\n      if (this.isTop) {\n        this.bbox.w = this.pWidth;\n      }\n      this.setColumnPWidths();\n      if (this.pWidth !== w) {\n        this.parent.invalidateBBox();\n      }\n      return this.pWidth !== w;\n    };\n    class_1.prototype.setColumnPWidths = function () {\n      var e_4, _a;\n      var W = this.cWidths;\n      try {\n        for (var _b = __values(this.pwidthCells), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var _d = __read(_c.value, 2),\n            cell = _d[0],\n            i = _d[1];\n          if (cell.setChildPWidths(false, W[i])) {\n            cell.invalidateBBox();\n            cell.getBBox();\n          }\n        }\n      } catch (e_4_1) {\n        e_4 = {\n          error: e_4_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_4) throw e_4.error;\n        }\n      }\n    };\n    class_1.prototype.getBBoxHD = function (height) {\n      var _a = __read(this.getAlignmentRow(), 2),\n        align = _a[0],\n        row = _a[1];\n      if (row === null) {\n        var a = this.font.params.axis_height;\n        var h2 = height / 2;\n        var HD = {\n          top: [0, height],\n          center: [h2, h2],\n          bottom: [height, 0],\n          baseline: [h2, h2],\n          axis: [h2 + a, h2 - a]\n        };\n        return HD[align] || [h2, h2];\n      } else {\n        var y = this.getVerticalPosition(row, align);\n        return [y, height - y];\n      }\n    };\n    class_1.prototype.getBBoxLR = function () {\n      if (this.hasLabels) {\n        var attributes = this.node.attributes;\n        var side = attributes.get('side');\n        var _a = __read(this.getPadAlignShift(side), 2),\n          pad = _a[0],\n          align = _a[1];\n        var labels = this.hasLabels && !!attributes.get('data-width-includes-label');\n        if (labels && this.frame && this.fSpace[0]) {\n          pad -= this.fSpace[0];\n        }\n        return align === 'center' && !labels ? [pad, pad] : side === 'left' ? [pad, 0] : [0, pad];\n      }\n      return [0, 0];\n    };\n    class_1.prototype.getPadAlignShift = function (side) {\n      var L = this.getTableData().L;\n      var sep = this.length2em(this.node.attributes.get('minlabelspacing'));\n      var pad = L + sep;\n      var _a = __read(this.styles == null ? ['', ''] : [this.styles.get('padding-left'), this.styles.get('padding-right')], 2),\n        lpad = _a[0],\n        rpad = _a[1];\n      if (lpad || rpad) {\n        pad = Math.max(pad, this.length2em(lpad || '0'), this.length2em(rpad || '0'));\n      }\n      var _b = __read(this.getAlignShift(), 2),\n        align = _b[0],\n        shift = _b[1];\n      if (align === side) {\n        shift = side === 'left' ? Math.max(pad, shift) - pad : Math.min(-pad, shift) + pad;\n      }\n      return [pad, align, shift];\n    };\n    class_1.prototype.getAlignShift = function () {\n      return this.isTop ? _super.prototype.getAlignShift.call(this) : [this.container.getChildAlign(this.containerI), 0];\n    };\n    class_1.prototype.getWidth = function () {\n      return this.pWidth || this.getBBox().w;\n    };\n    class_1.prototype.getEqualRowHeight = function () {\n      var _a = this.getTableData(),\n        H = _a.H,\n        D = _a.D;\n      var HD = Array.from(H.keys()).map(function (i) {\n        return H[i] + D[i];\n      });\n      return Math.max.apply(Math, HD);\n    };\n    class_1.prototype.getComputedWidths = function () {\n      var _this = this;\n      var W = this.getTableData().W;\n      var CW = Array.from(W.keys()).map(function (i) {\n        return typeof _this.cWidths[i] === 'number' ? _this.cWidths[i] : W[i];\n      });\n      if (this.node.attributes.get('equalcolumns')) {\n        CW = Array(CW.length).fill((0, numeric_js_1.max)(CW));\n      }\n      return CW;\n    };\n    class_1.prototype.getColumnWidths = function () {\n      var width = this.node.attributes.get('width');\n      if (this.node.attributes.get('equalcolumns')) {\n        return this.getEqualColumns(width);\n      }\n      var swidths = this.getColumnAttributes('columnwidth', 0);\n      if (width === 'auto') {\n        return this.getColumnWidthsAuto(swidths);\n      }\n      if ((0, string_js_1.isPercent)(width)) {\n        return this.getColumnWidthsPercent(swidths);\n      }\n      return this.getColumnWidthsFixed(swidths, this.length2em(width));\n    };\n    class_1.prototype.getEqualColumns = function (width) {\n      var n = Math.max(1, this.numCols);\n      var cwidth;\n      if (width === 'auto') {\n        var W = this.getTableData().W;\n        cwidth = (0, numeric_js_1.max)(W);\n      } else if ((0, string_js_1.isPercent)(width)) {\n        cwidth = this.percent(1 / n);\n      } else {\n        var w = (0, numeric_js_1.sum)([].concat(this.cLines, this.cSpace)) + 2 * this.fSpace[0];\n        cwidth = Math.max(0, this.length2em(width) - w) / n;\n      }\n      return Array(this.numCols).fill(cwidth);\n    };\n    class_1.prototype.getColumnWidthsAuto = function (swidths) {\n      var _this = this;\n      return swidths.map(function (x) {\n        if (x === 'auto' || x === 'fit') return null;\n        if ((0, string_js_1.isPercent)(x)) return x;\n        return _this.length2em(x);\n      });\n    };\n    class_1.prototype.getColumnWidthsPercent = function (swidths) {\n      var _this = this;\n      var hasFit = swidths.indexOf('fit') >= 0;\n      var W = (hasFit ? this.getTableData() : {\n        W: null\n      }).W;\n      return Array.from(swidths.keys()).map(function (i) {\n        var x = swidths[i];\n        if (x === 'fit') return null;\n        if (x === 'auto') return hasFit ? W[i] : null;\n        if ((0, string_js_1.isPercent)(x)) return x;\n        return _this.length2em(x);\n      });\n    };\n    class_1.prototype.getColumnWidthsFixed = function (swidths, width) {\n      var _this = this;\n      var indices = Array.from(swidths.keys());\n      var fit = indices.filter(function (i) {\n        return swidths[i] === 'fit';\n      });\n      var auto = indices.filter(function (i) {\n        return swidths[i] === 'auto';\n      });\n      var n = fit.length || auto.length;\n      var W = (n ? this.getTableData() : {\n        W: null\n      }).W;\n      var cwidth = width - (0, numeric_js_1.sum)([].concat(this.cLines, this.cSpace)) - 2 * this.fSpace[0];\n      var dw = cwidth;\n      indices.forEach(function (i) {\n        var x = swidths[i];\n        dw -= x === 'fit' || x === 'auto' ? W[i] : _this.length2em(x, cwidth);\n      });\n      var fw = n && dw > 0 ? dw / n : 0;\n      return indices.map(function (i) {\n        var x = swidths[i];\n        if (x === 'fit') return W[i] + fw;\n        if (x === 'auto') return W[i] + (fit.length === 0 ? fw : 0);\n        return _this.length2em(x, cwidth);\n      });\n    };\n    class_1.prototype.getVerticalPosition = function (i, align) {\n      var equal = this.node.attributes.get('equalrows');\n      var _a = this.getTableData(),\n        H = _a.H,\n        D = _a.D;\n      var HD = equal ? this.getEqualRowHeight() : 0;\n      var space = this.getRowHalfSpacing();\n      var y = this.fLine;\n      for (var j = 0; j < i; j++) {\n        y += space[j] + (equal ? HD : H[j] + D[j]) + space[j + 1] + this.rLines[j];\n      }\n      var _b = __read(equal ? [(HD + H[i] - D[i]) / 2, (HD - H[i] + D[i]) / 2] : [H[i], D[i]], 2),\n        h = _b[0],\n        d = _b[1];\n      var offset = {\n        top: 0,\n        center: space[i] + (h + d) / 2,\n        bottom: space[i] + h + d + space[i + 1],\n        baseline: space[i] + h,\n        axis: space[i] + h - .25\n      };\n      y += offset[align] || 0;\n      return y;\n    };\n    class_1.prototype.getEmHalfSpacing = function (fspace, space, scale) {\n      if (scale === void 0) {\n        scale = 1;\n      }\n      var fspaceEm = this.em(fspace * scale);\n      var spaceEm = this.addEm(space, 2 / scale);\n      spaceEm.unshift(fspaceEm);\n      spaceEm.push(fspaceEm);\n      return spaceEm;\n    };\n    class_1.prototype.getRowHalfSpacing = function () {\n      var space = this.rSpace.map(function (x) {\n        return x / 2;\n      });\n      space.unshift(this.fSpace[1]);\n      space.push(this.fSpace[1]);\n      return space;\n    };\n    class_1.prototype.getColumnHalfSpacing = function () {\n      var space = this.cSpace.map(function (x) {\n        return x / 2;\n      });\n      space.unshift(this.fSpace[0]);\n      space.push(this.fSpace[0]);\n      return space;\n    };\n    class_1.prototype.getAlignmentRow = function () {\n      var _a = __read((0, string_js_1.split)(this.node.attributes.get('align')), 2),\n        align = _a[0],\n        row = _a[1];\n      if (row == null) return [align, null];\n      var i = parseInt(row);\n      if (i < 0) i += this.numRows + 1;\n      return [align, i < 1 || i > this.numRows ? null : i - 1];\n    };\n    class_1.prototype.getColumnAttributes = function (name, i) {\n      if (i === void 0) {\n        i = 1;\n      }\n      var n = this.numCols - i;\n      var columns = this.getAttributeArray(name);\n      if (columns.length === 0) return null;\n      while (columns.length < n) {\n        columns.push(columns[columns.length - 1]);\n      }\n      if (columns.length > n) {\n        columns.splice(n);\n      }\n      return columns;\n    };\n    class_1.prototype.getRowAttributes = function (name, i) {\n      if (i === void 0) {\n        i = 1;\n      }\n      var n = this.numRows - i;\n      var rows = this.getAttributeArray(name);\n      if (rows.length === 0) return null;\n      while (rows.length < n) {\n        rows.push(rows[rows.length - 1]);\n      }\n      if (rows.length > n) {\n        rows.splice(n);\n      }\n      return rows;\n    };\n    class_1.prototype.getAttributeArray = function (name) {\n      var value = this.node.attributes.get(name);\n      if (!value) return [this.node.attributes.getDefault(name)];\n      return (0, string_js_1.split)(value);\n    };\n    class_1.prototype.addEm = function (list, n) {\n      var _this = this;\n      if (n === void 0) {\n        n = 1;\n      }\n      if (!list) return null;\n      return list.map(function (x) {\n        return _this.em(x / n);\n      });\n    };\n    class_1.prototype.convertLengths = function (list) {\n      var _this = this;\n      if (!list) return null;\n      return list.map(function (x) {\n        return _this.length2em(x);\n      });\n    };\n    return class_1;\n  }(Base);\n}\nexports.CommonMtableMixin = CommonMtableMixin;","map":{"version":3,"names":["BBox_js_1","require","string_js_1","numeric_js_1","CommonMtableMixin","Base","_super","__extends","class_1","args","_i","arguments","length","_this","apply","__spreadArray","__read","numCols","numRows","data","pwidthCells","pWidth","max","tableRows","map","row","numCells","childNodes","hasLabels","reduce","value","node","isKind","findContainer","isTop","container","parent","jax","table","getPercentageWidth","attributes","frame","get","fLine","fSpace","convertLengths","getAttributeArray","cSpace","getColumnAttributes","rSpace","getRowAttributes","cLines","x","rLines","cWidths","getColumnWidths","stretchRows","stretchColumns","Object","defineProperty","prototype","notParent","containerI","childPosition","bbox","pwidth","BBox","fullWidth","width","isPercent","equal","HD","getEqualRowHeight","_a","getTableData","H","D","rows","i","hd","stretchChildren","stretchColumn","W","stretchy","_d","__values","_e","next","done","cell","getChild","child","stretch","dir","canStretch","push","count","nodeCount","all","_f","_g","noStretch","w","getBBox","stretchy_1","stretchy_1_1","coreMO","getStretchedVariant","Array","fill","NH","ND","LW","j","M","align","updateHDW","recordPWidthCell","labeled","extendHD","L","h","d","scale","rscale","getProperty","m","computeBBox","_recompute","height","sum","concat","CW","getComputedWidths","Math","length2em","_b","getBBoxHD","_c","getBBoxLR","R","setColumnPWidths","setChildPWidths","cwidth","_clear","labelInWidth","cols","percent","getColumnWidthsFixed","invalidateBBox","getAlignmentRow","a","font","params","axis_height","h2","top","center","bottom","baseline","axis","y","getVerticalPosition","side","getPadAlignShift","pad","labels","sep","styles","lpad","rpad","getAlignShift","shift","min","call","getChildAlign","getWidth","from","keys","getEqualColumns","swidths","getColumnWidthsAuto","getColumnWidthsPercent","n","hasFit","indexOf","indices","fit","filter","auto","dw","forEach","fw","space","getRowHalfSpacing","offset","getEmHalfSpacing","fspace","fspaceEm","em","spaceEm","addEm","unshift","getColumnHalfSpacing","split","parseInt","name","columns","splice","getDefault","list","exports"],"sources":["/Users/nickprince/Desktop/Flowise Working Commit/node_modules/mathjax-full/ts/output/common/Wrappers/mtable.ts"],"sourcesContent":["/*************************************************************\n *\n *  Copyright (c) 2017-2022 The MathJax Consortium\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\n/**\n * @fileoverview  Implements the CommonMtable wrapper mixin for the MmlMtable object\n *\n * @author dpvc@mathjax.org (Davide Cervone)\n */\n\nimport {AnyWrapper, WrapperConstructor, Constructor} from '../Wrapper.js';\nimport {CommonMtr} from './mtr.js';\nimport {CommonMo} from './mo.js';\nimport {BBox} from '../../../util/BBox.js';\nimport {DIRECTION} from '../FontData.js';\nimport {split, isPercent} from '../../../util/string.js';\nimport {sum, max} from '../../../util/numeric.js';\n\n/*****************************************************************/\n/**\n * The heights, depths, and widths of the rows and columns\n * Plus the natural height and depth (i.e., without the labels)\n * Plus the label column width\n */\nexport type TableData = {\n  H: number[];\n  D: number[];\n  W: number[];\n  NH: number[];\n  ND: number[];\n  L: number;\n};\n\n/**\n * An array of table dimensions\n */\nexport type ColumnWidths = (string | number | null)[];\n\n/*****************************************************************/\n/**\n * The CommonMtable interface\n *\n * @template C   The class for table cells\n * @template R   The class for table rows\n */\nexport interface CommonMtable<C extends AnyWrapper, R extends CommonMtr<C>> extends AnyWrapper {\n\n  /**\n   * The number of columns and rows in the table\n   */\n  numCols: number;\n  numRows: number;\n\n  /**\n   * True if there are labeled rows\n   */\n  hasLabels: boolean;\n\n  /**\n   * True if this mtable is the top element, or in a top-most mrow\n   */\n  isTop: boolean;\n\n  /**\n   * The parent node of this table (skipping non-parents and mrows)\n   *   and the position of the table as a child node\n   */\n  container: AnyWrapper;\n  containerI: number;\n\n  /**\n   * The spacing and line data\n   */\n  frame: boolean;\n  fLine: number;\n  fSpace: number[];\n  cSpace: number[];\n  rSpace: number[];\n  cLines: number[];\n  rLines: number[];\n  cWidths: (number | string)[];\n\n  /**\n   * The bounding box information for the table rows and columns\n   */\n  data: TableData;\n\n  /**\n   * The table cells that have percentage-width content\n   */\n  pwidthCells: [C, number][];\n\n  /**\n   * The full width of a percentage-width table\n   */\n  pWidth: number;\n\n  /**\n   * The rows of the table\n   */\n  readonly tableRows: R[];\n\n  /**\n   * @override\n   */\n  childNodes: R[];\n\n  /**\n   * Find the container and the child position of the table\n   */\n  findContainer(): void;\n\n  /**\n   * If the table has a precentage width or has labels, set the pwidth of the bounding box\n   */\n  getPercentageWidth(): void;\n\n  /**\n   * Stretch the rows to the equal height or natural height\n   */\n  stretchRows(): void;\n\n  /**\n   * Stretch the columns to their proper widths\n   */\n  stretchColumns(): void;\n\n  /**\n   * Handle horizontal stretching within the ith column\n   *\n   * @param {number} i   The column number\n   * @param {number} W   The computed width of the column (or null of not computed)\n   */\n  stretchColumn(i: number, W: number): void;\n\n  /**\n   * Determine the row heights and depths, the column widths,\n   * and the natural width and height of the table.\n   *\n   * @return {TableData}  The dimensions of the rows and columns\n   */\n  getTableData(): TableData;\n\n  /**\n   * @param {C} cell         The cell whose height, depth, and width are to be added into the H, D, W arrays\n   * @param {number} i       The column number for the cell\n   * @param {number} j       The row number for the cell\n   * @param {string} align   The row alignment\n   * @param {number[]} H     The maximum height for each of the rows\n   * @param {number[]} D     The maximum depth for each of the rows\n   * @param {number[]} W     The maximum width for each column\n   * @param {number} M       The current height for items aligned top and bottom\n   * @return {number}        The updated value for M\n   */\n  updateHDW(cell: C, i: number, j: number, align: string, H: number[], D: number[], W: number[], M: number): number;\n\n  /**\n   * Extend the H and D of a row to cover the maximum height needed by top/bottom aligned items\n   *\n   * @param {number} i     The row whose hight and depth should be adjusted\n   * @param {number[]} H   The row heights\n   * @param {number[]} D   The row depths\n   * @param {number} M     The maximum height of top/bottom aligned items\n   */\n  extendHD(i: number, H: number[], D: number[], M: number): void;\n\n  /**\n   * Set cell widths for columns with percentage width children\n   */\n  setColumnPWidths(): void;\n\n  /**\n   * @param {number} height   The total height of the table\n   * @return {number[]}       The [height, depth] for the aligned table\n   */\n  getBBoxHD(height: number): number[];\n\n  /**\n   * Get bbox left and right amounts to cover labels\n   */\n  getBBoxLR(): number[];\n\n  /**\n   * @param {string} side                 The side for the labels\n   * @return {[number, string, number]}   The padding, alignment, and shift amounts\n   */\n  getPadAlignShift(side: string): [number, string, number];\n\n  /**\n   * @return {number}    The true width of the table (without labels)\n   */\n  getWidth(): number;\n\n  /**\n   * @return {number}   The maximum height of a row\n   */\n  getEqualRowHeight(): number;\n\n  /**\n   * @return {number[]}   The array of computed widths\n   */\n  getComputedWidths(): number[];\n\n  /**\n   * Determine the column widths that can be computed (and need to be set).\n   * The resulting arrays will have numbers for fixed-size arrays,\n   *   strings for percentage sizes that can't be determined now,\n   *   and null for stretchy columns tht will expand to fill the extra space.\n   * Depending on the width specified for the table, different column\n   *  values can be determined.\n   *\n   * @return {ColumnWidths}  The array of widths\n   */\n  getColumnWidths(): ColumnWidths;\n\n  /**\n   * For tables with equal columns, get the proper amount per row.\n   *\n   * @return {ColumnWidths}  The array of widths\n   */\n  getEqualColumns(width: string): ColumnWidths;\n\n  /**\n   * For tables with width=\"auto\", auto and fit columns\n   * will end up being natural width, so don't need to\n   * set those explicitly.\n   *\n   * @return {ColumnWidths}  The array of widths\n   */\n  getColumnWidthsAuto(swidths: string[]): ColumnWidths;\n\n  /**\n   * For tables with percentage widths, let 'fit' columns (or 'auto'\n   * columns if there are not 'fit' ones) will stretch automatically,\n   * but for 'auto' columns (when there are 'fit' ones), set the size\n   * to the natural size of the column.\n   *\n   * @param {string[]} widths  Strings giving the widths\n   * @return {ColumnWidths}    The array of widths\n   */\n  getColumnWidthsPercent(widths: string[]): ColumnWidths;\n\n  /**\n   * For fixed-width tables, compute the column widths of all columns.\n   *\n   * @return {ColumnWidths}  The array of widths\n   */\n  getColumnWidthsFixed(swidths: string[], width: number): ColumnWidths;\n\n  /**\n   * @param {number} i      The row number (starting at 0)\n   * @param {string} align  The alignment on that row\n   * @return {number}       The offest of the alignment position from the top of the table\n   */\n  getVerticalPosition(i: number, align: string): number;\n\n  /**\n   * @param {number} fspace   The frame spacing to use\n   * @param {number[]} space  The array of spacing values to convert to strings\n   * @param {number} scale    A scaling factor to use for the sizes\n   * @return {string[]}       The half-spacing as stings with units of \"em\"\n   *                           with frame spacing at the beginning and end\n   */\n  getEmHalfSpacing(fspace: number, space: number[], scale?: number): string[];\n\n  /**\n   * @return {number[]}   The half-spacing for rows with frame spacing at the ends\n   */\n  getRowHalfSpacing(): number[];\n\n  /**\n   * @return {number[]}   The half-spacing for columns with frame spacing at the ends\n   */\n  getColumnHalfSpacing(): number[];\n\n  /**\n   * @return {[string,number|null]}  The alignment and row number (based at 0) or null\n   */\n  getAlignmentRow(): [string, number | null];\n\n  /**\n   * @param {string} name           The name of the attribute to get as an array\n   * @param {number=} i             Return this many fewer than numCols entries\n   * @return {string[]}             The array of values in the given attribute, split at spaces,\n   *                                 padded to the number of table columns (minus 1) by repeating the last entry\n   */\n  getColumnAttributes(name: string, i?: number): string[];\n\n  /**\n   * @param {string} name           The name of the attribute to get as an array\n   * @param {number=} i             Return this many fewer than numRows entries\n   * @return {string[]}             The array of values in the given attribute, split at spaces,\n   *                                 padded to the number of table rows (minus 1) by repeating the last entry\n   */\n  getRowAttributes(name: string, i?: number): string[];\n\n  /**\n   * @param {string} name           The name of the attribute to get as an array\n   * @return {string[]}             The array of values in the given attribute, split at spaces\n   *                                 (after leading and trailing spaces are removed, and multiple\n   *                                  spaces have been collapsed to one).\n   */\n  getAttributeArray(name: string): string[];\n\n  /**\n   * Adds \"em\" to a list of dimensions, after dividing by n (defaults to 1).\n   *\n   * @param {string[]} list   The array of dimensions (in em's)\n   * @param {nunber=} n       The number to divide each dimension by after converted\n   * @return {string[]}       The array of values with \"em\" added\n   */\n  addEm(list: number[], n?: number): string[];\n\n  /**\n   * Converts an array of dimensions (with arbitrary units) to an array of numbers\n   *   representing the dimensions in units of em's.\n   *\n   * @param {string[]} list   The array of dimensions to be turned into em's\n   * @return {number[]}       The array of values converted to em's\n   */\n  convertLengths(list: string[]): number[];\n\n}\n\n/**\n * Shorthand for the CommonMtable constructor\n */\nexport type MtableConstructor<C extends AnyWrapper, R extends CommonMtr<C>> = Constructor<CommonMtable<C, R>>;\n\n/*****************************************************************/\n/**\n * The CommonMtable wrapper mixin for the MmlMtable object\n *\n * @template C  The table cell class\n * @temlpate R  the table row class\n * @template T  The Wrapper class constructor type\n */\nexport function CommonMtableMixin<\n  C extends AnyWrapper,\n  R extends CommonMtr<C>,\n  T extends WrapperConstructor\n>(Base: T): MtableConstructor<C, R> & T {\n\n  return class extends Base {\n\n    /**\n     * The number of columns in the table\n     */\n    public numCols: number = 0;\n    /**\n     * The number of rows in the table\n     */\n    public numRows: number = 0;\n\n    /**\n     * True if there are labeled rows\n     */\n    public hasLabels: boolean;\n\n    /**\n     * True if this mtable is the top element, or in a top-most mrow\n     */\n    public isTop: boolean;\n\n    /**\n     * The parent node of this table (skipping non-parents and mrows)\n     */\n    public container: AnyWrapper;\n    /**\n     * The position of the table as a child node of its container\n     */\n    public containerI: number;\n\n    /**\n     * True if there is a frame\n     */\n    public frame: boolean;\n    /**\n     * The size of the frame line (or 0 if none)\n     */\n    public fLine: number;\n    /**\n     * frame spacing on the left and right\n     */\n    public fSpace: number[];\n    /**\n     * The spacing between columns\n     */\n    public cSpace: number[];\n    /**\n     * The spacing between rows\n     */\n    public rSpace: number[];\n    /**\n     * The width of columns lines (or 0 if no line for the column)\n     */\n    public cLines: number[];\n    /**\n     * The width of row lines (or 0 if no lone for that row)\n     */\n    public rLines: number[];\n    /**\n     * The column widths (or percentages, etc.)\n     */\n    public cWidths: (number | string)[];\n\n    /**\n     * The bounding box information for the table rows and columns\n     */\n    public data: TableData = null;\n\n    /**\n     * The table cells that have percentage-width content\n     */\n    public pwidthCells: [C, number][] = [];\n\n    /**\n     * The full width of a percentage-width table\n     */\n    public pWidth: number = 0;\n\n    /**\n     * @return {R[]}  The rows of the table\n     */\n    get tableRows(): R[] {\n      return this.childNodes;\n    }\n\n    /******************************************************************/\n\n    /**\n     * @override\n     * @constructor\n     */\n    constructor(...args: any[]) {\n      super(...args);\n      //\n      // Determine the number of columns and rows, and whether the table is stretchy\n      //\n      this.numCols = max(this.tableRows.map(row => row.numCells));\n      this.numRows = this.childNodes.length;\n      this.hasLabels = this.childNodes.reduce((value, row) => value || row.node.isKind('mlabeledtr'), false);\n      this.findContainer();\n      this.isTop = !this.container || (this.container.node.isKind('math') && !this.container.parent);\n      if (this.isTop) {\n        this.jax.table = this;\n      }\n      this.getPercentageWidth();\n      //\n      // Get the frame, row, and column parameters\n      //\n      const attributes = this.node.attributes;\n      this.frame = attributes.get('frame') !== 'none';\n      this.fLine = (this.frame && attributes.get('frame') ? .07 : 0);\n      this.fSpace = (this.frame ? this.convertLengths(this.getAttributeArray('framespacing')) : [0, 0]);\n      this.cSpace = this.convertLengths(this.getColumnAttributes('columnspacing'));\n      this.rSpace = this.convertLengths(this.getRowAttributes('rowspacing'));\n      this.cLines = this.getColumnAttributes('columnlines').map(x => (x === 'none' ? 0 : .07));\n      this.rLines = this.getRowAttributes('rowlines').map(x => (x === 'none' ? 0 : .07));\n      this.cWidths = this.getColumnWidths();\n      //\n      // Stretch the rows and columns\n      //\n      this.stretchRows();\n      this.stretchColumns();\n    }\n\n    /**\n     * Find the container and the child position of the table\n     */\n    public findContainer() {\n      let node = this as AnyWrapper;\n      let parent = node.parent as AnyWrapper;\n      while (parent && (parent.node.notParent || parent.node.isKind('mrow'))) {\n        node = parent;\n        parent = parent.parent;\n      }\n      this.container = parent;\n      this.containerI = node.node.childPosition();\n    }\n\n    /**\n     * If the table has a precentage width or has labels, set the pwidth of the bounding box\n     */\n    public getPercentageWidth() {\n      if (this.hasLabels) {\n        this.bbox.pwidth = BBox.fullWidth;\n      } else {\n        const width = this.node.attributes.get('width') as string;\n        if (isPercent(width)) {\n          this.bbox.pwidth = width;\n        }\n      }\n    }\n\n    /**\n     * Stretch the rows to the equal height or natural height\n     */\n    public stretchRows() {\n      const equal = this.node.attributes.get('equalrows') as boolean;\n      const HD = (equal ? this.getEqualRowHeight() : 0);\n      const {H, D} = (equal ? this.getTableData() : {H: [0], D: [0]});\n      const rows = this.tableRows;\n      for (let i = 0; i < this.numRows; i++) {\n        const hd = (equal ? [(HD + H[i] - D[i]) / 2, (HD - H[i] + D[i]) / 2] : null);\n        rows[i].stretchChildren(hd);\n      }\n    }\n\n    /**\n     * Stretch the columns to their proper widths\n     */\n    public stretchColumns() {\n      for (let i = 0; i < this.numCols; i++) {\n        const width = (typeof this.cWidths[i] === 'number' ? this.cWidths[i] as number : null);\n        this.stretchColumn(i, width);\n      }\n    }\n\n    /**\n     * Handle horizontal stretching within the ith column\n     *\n     * @param {number} i   The column number\n     * @param {number} W   The computed width of the column (or null of not computed)\n     */\n    public stretchColumn(i: number, W: number) {\n      let stretchy: AnyWrapper[] = [];\n      //\n      //  Locate and count the stretchy children\n      //\n      for (const row of this.tableRows) {\n        const cell = row.getChild(i);\n        if (cell) {\n          const child = cell.childNodes[0];\n          if (child.stretch.dir === DIRECTION.None &&\n              child.canStretch(DIRECTION.Horizontal)) {\n            stretchy.push(child);\n          }\n        }\n      }\n      let count = stretchy.length;\n      let nodeCount = this.childNodes.length;\n      if (count && nodeCount > 1) {\n        if (W === null) {\n          W = 0;\n          //\n          //  If all the children are stretchy, find the largest one,\n          //  otherwise, find the width of the non-stretchy children.\n          //\n          let all = (count > 1 && count === nodeCount);\n          for (const row of this.tableRows) {\n            const cell = row.getChild(i);\n            if (cell) {\n              const child = cell.childNodes[0];\n              const noStretch = (child.stretch.dir === DIRECTION.None);\n              if (all || noStretch) {\n                const {w} = child.getBBox(noStretch);\n                if (w > W) {\n                  W = w;\n                }\n              }\n            }\n          }\n        }\n        //\n        //  Stretch the stretchable children\n        //\n        for (const child of stretchy) {\n          (child.coreMO() as CommonMo).getStretchedVariant([W]);\n        }\n      }\n    }\n\n    /******************************************************************/\n\n    /**\n     * Determine the row heights and depths, the column widths,\n     * and the natural width and height of the table.\n     *\n     * @return {TableData}  The dimensions of the rows and columns\n     */\n    public getTableData(): TableData {\n      if (this.data) {\n        return this.data;\n      }\n      const H = new Array(this.numRows).fill(0);\n      const D = new Array(this.numRows).fill(0);\n      const W = new Array(this.numCols).fill(0);\n      const NH = new Array(this.numRows);\n      const ND = new Array(this.numRows);\n      const LW = [0];\n      const rows = this.tableRows;\n      for (let j = 0; j < rows.length; j++) {\n        let M = 0;\n        const row = rows[j];\n        const align = row.node.attributes.get('rowalign') as string;\n        for (let i = 0; i < row.numCells; i++) {\n          const cell = row.getChild(i);\n          M = this.updateHDW(cell, i, j, align, H, D, W, M);\n          this.recordPWidthCell(cell, i);\n        }\n        NH[j] = H[j];\n        ND[j] = D[j];\n        if (row.labeled) {\n          M = this.updateHDW(row.childNodes[0], 0, j, align, H, D, LW, M);\n        }\n        this.extendHD(j, H, D, M);\n        this.extendHD(j, NH, ND, M);\n      }\n      const L = LW[0];\n      this.data = {H, D, W, NH, ND, L};\n      return this.data;\n    }\n\n    /**\n     * @override\n     */\n    public updateHDW(\n      cell: C, i: number, j: number, align: string, H: number[], D: number[], W: number[], M: number\n    ): number {\n      let {h, d, w} = cell.getBBox();\n      const scale = cell.parent.bbox.rscale;\n      if (cell.parent.bbox.rscale !== 1) {\n        h *= scale;\n        d *= scale;\n        w *= scale;\n      }\n      if (this.node.getProperty('useHeight')) {\n        if (h < .75) h = .75;\n        if (d < .25) d = .25;\n      }\n      let m = 0;\n      align = cell.node.attributes.get('rowalign') as string || align;\n      if (align !== 'baseline' && align !== 'axis') {\n        m = h + d;\n        h = d = 0;\n      }\n      if (h > H[j]) H[j] = h;\n      if (d > D[j]) D[j] = d;\n      if (m > M) M = m;\n      if (W && w > W[i]) W[i] = w;\n      return M;\n    }\n\n    /**\n     * @override\n     */\n    public extendHD(i: number, H: number[], D: number[], M: number) {\n      const d = (M - (H[i] + D[i])) / 2;\n      if (d < .00001) return;\n      H[i] += d;\n      D[i] += d;\n    }\n\n    /**\n     * @param {C} cell     The cell to check for percentage widths\n     * @param {number} i   The column index of the cell\n     */\n    public recordPWidthCell(cell: C, i: number) {\n      if (cell.childNodes[0] && cell.childNodes[0].getBBox().pwidth) {\n        this.pwidthCells.push([cell, i]);\n      }\n    }\n\n    /**\n     * @override\n     */\n    public computeBBox(bbox: BBox, _recompute: boolean = false) {\n      const {H, D} = this.getTableData();\n      let height, width;\n      //\n      // For equal rows, use the common height and depth for all rows\n      // Otherwise, use the height and depths for each row separately.\n      // Add in the spacing, line widths, and frame size.\n      //\n      if (this.node.attributes.get('equalrows') as boolean) {\n        const HD = this.getEqualRowHeight();\n        height = sum([].concat(this.rLines, this.rSpace)) + HD * this.numRows;\n      } else {\n        height = sum(H.concat(D, this.rLines, this.rSpace));\n      }\n      height += 2 * (this.fLine + this.fSpace[1]);\n      //\n      //  Get the widths of all columns\n      //\n      const CW = this.getComputedWidths();\n      //\n      //  Get the expected width of the table\n      //\n      width = sum(CW.concat(this.cLines, this.cSpace)) + 2 * (this.fLine + this.fSpace[0]);\n      //\n      //  If the table width is not 'auto', determine the specified width\n      //    and pick the larger of the specified and computed widths.\n      //\n      const w = this.node.attributes.get('width') as string;\n      if (w !== 'auto') {\n        width = Math.max(this.length2em(w, 0) + 2 * this.fLine, width);\n      }\n      //\n      //  Return the bounding box information\n      //\n      let [h, d] = this.getBBoxHD(height);\n      bbox.h = h;\n      bbox.d = d;\n      bbox.w = width;\n      let [L, R] = this.getBBoxLR();\n      bbox.L = L;\n      bbox.R = R;\n      //\n      //  Handle cell widths if width is not a percentage\n      //\n      if (!isPercent(w)) {\n        this.setColumnPWidths();\n      }\n    }\n\n    /**\n     * @override\n     */\n    public setChildPWidths(_recompute: boolean, cwidth: number, _clear: boolean) {\n      const width = this.node.attributes.get('width') as string;\n      if (!isPercent(width)) return false;\n      if (!this.hasLabels) {\n        this.bbox.pwidth = '';\n        this.container.bbox.pwidth = '';\n      }\n      const {w, L, R} = this.bbox;\n      const labelInWidth = this.node.attributes.get('data-width-includes-label') as boolean;\n      const W = Math.max(w, this.length2em(width, Math.max(cwidth, L + w + R))) - (labelInWidth ? L + R : 0);\n      const cols = (this.node.attributes.get('equalcolumns') as boolean ?\n                    Array(this.numCols).fill(this.percent(1 / Math.max(1, this.numCols))) :\n                    this.getColumnAttributes('columnwidth', 0));\n      this.cWidths = this.getColumnWidthsFixed(cols, W);\n      const CW = this.getComputedWidths();\n      this.pWidth = sum(CW.concat(this.cLines, this.cSpace)) + 2 * (this.fLine + this.fSpace[0]);\n      if (this.isTop) {\n        this.bbox.w = this.pWidth;\n      }\n      this.setColumnPWidths();\n      if (this.pWidth !== w) {\n        this.parent.invalidateBBox();\n      }\n      return this.pWidth !== w;\n    }\n\n    /**\n     * Finalize any cells that have percentage-width content\n     */\n    public setColumnPWidths() {\n      const W = this.cWidths as number[];\n      for (const [cell, i] of this.pwidthCells) {\n        if (cell.setChildPWidths(false, W[i])) {\n          cell.invalidateBBox();\n          cell.getBBox();\n        }\n      }\n    }\n\n    /**\n     * @param {number} height   The total height of the table\n     * @return {[number, number]}  The [height, depth] for the aligned table\n     */\n    public getBBoxHD(height: number): [number, number] {\n      const [align, row] = this.getAlignmentRow();\n      if (row === null) {\n        const a = this.font.params.axis_height;\n        const h2 = height / 2;\n        const HD: {[key: string]: [number, number]} = {\n          top: [0, height],\n          center: [h2, h2],\n          bottom: [height, 0],\n          baseline: [h2, h2],\n          axis: [h2 + a, h2 - a]\n        };\n        return HD[align] || [h2, h2];\n      } else {\n        const y = this.getVerticalPosition(row, align);\n        return [y, height - y];\n      }\n    }\n\n    /**\n     * Get bbox left and right amounts to cover labels\n     */\n    public getBBoxLR() {\n      if (this.hasLabels) {\n        const attributes = this.node.attributes;\n        const side = attributes.get('side') as string;\n        let [pad, align] = this.getPadAlignShift(side);\n        //\n        // If labels are included in the width,\n        //   remove the frame spacing if there is no frame line (added by multline)\n        //   and use left or right justification rather than centering so that\n        //   there is no extra space reserved for the label on the opposite side,\n        //   (as there usually is to center the equation).\n        //\n        const labels = this.hasLabels && !!attributes.get('data-width-includes-label');\n        if (labels && this.frame && this.fSpace[0]) {\n          pad -= this.fSpace[0];\n        }\n        return (align === 'center' && !labels ? [pad, pad] :\n                side === 'left' ? [pad, 0] : [0, pad]);\n      }\n      return [0, 0];\n    }\n\n    /**\n     * @param {string} side                 The side for the labels\n     * @return {[number, string, number]}   The padding, alignment, and shift amounts\n     */\n    public getPadAlignShift(side: string): [number, string, number] {\n      //\n      //  Make sure labels don't overlap table\n      //\n      const {L} = this.getTableData();\n      const sep = this.length2em(this.node.attributes.get('minlabelspacing'));\n      let pad = L + sep;\n      const [lpad, rpad] = (this.styles == null ? ['', ''] :\n                            [this.styles.get('padding-left'), this.styles.get('padding-right')]);\n      if (lpad || rpad) {\n        pad = Math.max(pad, this.length2em(lpad || '0'), this.length2em(rpad || '0'));\n      }\n      //\n      //  Handle indentation\n      //\n      let [align, shift] = this.getAlignShift();\n      if (align === side) {\n        shift = (side === 'left' ? Math.max(pad, shift) - pad : Math.min(-pad, shift) + pad);\n      }\n      return [pad, align, shift] as [number, string, number];\n    }\n\n    /**\n     * @override\n     */\n    public getAlignShift() {\n      return (this.isTop ? super.getAlignShift() :\n              [this.container.getChildAlign(this.containerI), 0] as [string, number]);\n    }\n\n    /**\n     * @return {number}    The true width of the table (without labels)\n     */\n    public getWidth(): number {\n      return this.pWidth || this.getBBox().w;\n    }\n\n    /******************************************************************/\n\n    /**\n     * @return {number}   The maximum height of a row\n     */\n    public getEqualRowHeight(): number {\n      const {H, D} = this.getTableData();\n      const HD = Array.from(H.keys()).map(i => H[i] + D[i]);\n      return Math.max.apply(Math, HD);\n    }\n\n    /**\n     * @return {number[]}   The array of computed widths\n     */\n    public getComputedWidths(): number[] {\n      const W = this.getTableData().W;\n      let CW = Array.from(W.keys()).map(i => {\n        return (typeof this.cWidths[i] === 'number' ? this.cWidths[i] as number : W[i]);\n      });\n      if (this.node.attributes.get('equalcolumns') as boolean) {\n        CW = Array(CW.length).fill(max(CW));\n      }\n      return CW;\n    }\n\n    /**\n     * Determine the column widths that can be computed (and need to be set).\n     * The resulting arrays will have numbers for fixed-size arrays,\n     *   strings for percentage sizes that can't be determined now,\n     *   and null for stretchy columns that will expand to fill the extra space.\n     * Depending on the width specified for the table, different column\n     *  values can be determined.\n     *\n     * @return {(string|number|null)[]}  The array of widths\n     */\n    public getColumnWidths(): (string | number | null)[] {\n      const width = this.node.attributes.get('width') as string;\n      if (this.node.attributes.get('equalcolumns') as boolean) {\n        return this.getEqualColumns(width);\n      }\n      const swidths = this.getColumnAttributes('columnwidth', 0);\n      if (width === 'auto') {\n        return this.getColumnWidthsAuto(swidths);\n      }\n      if (isPercent(width)) {\n        return this.getColumnWidthsPercent(swidths);\n      }\n      return this.getColumnWidthsFixed(swidths, this.length2em(width));\n    }\n\n    /**\n     * For tables with equal columns, get the proper amount per column.\n     *\n     * @param {string} width   The width attribute of the table\n     * @return {(string|number|null)[]}  The array of widths\n     */\n    public getEqualColumns(width: string): (string | number | null)[] {\n      const n = Math.max(1, this.numCols);\n      let cwidth;\n      if (width === 'auto') {\n        const {W} = this.getTableData();\n        cwidth = max(W);\n      } else if (isPercent(width)) {\n        cwidth = this.percent(1 / n);\n      } else {\n        const w = sum([].concat(this.cLines, this.cSpace)) + 2 * this.fSpace[0];\n        cwidth = Math.max(0, this.length2em(width) - w) / n;\n      }\n      return Array(this.numCols).fill(cwidth);\n    }\n\n    /**\n     * For tables with width=\"auto\", auto and fit columns\n     * will end up being natural width, so don't need to\n     * set those explicitly.\n     *\n     * @param {string[]} swidths   The split and padded columnwidths attribute\n     * @return {ColumnWidths}  The array of widths\n     */\n    public getColumnWidthsAuto(swidths: string[]): ColumnWidths {\n      return swidths.map(x => {\n        if (x === 'auto' || x === 'fit') return null;\n        if (isPercent(x)) return x;\n        return this.length2em(x);\n      });\n    }\n\n    /**\n     * For tables with percentage widths, the 'fit' columns (or 'auto'\n     * columns if there are not 'fit' ones) will stretch automatically,\n     * but for 'auto' columns (when there are 'fit' ones), set the size\n     * to the natural size of the column.\n     *\n     * @param {string[]} swidths   The split and padded columnwidths attribute\n     * @return {ColumnWidths}      The array of widths\n     */\n    public getColumnWidthsPercent(swidths: string[]): ColumnWidths {\n      const hasFit = swidths.indexOf('fit') >= 0;\n      const {W} = (hasFit ? this.getTableData() : {W: null});\n      return Array.from(swidths.keys()).map(i => {\n        const x = swidths[i];\n        if (x === 'fit') return null;\n        if (x === 'auto') return (hasFit ? W[i] : null);\n        if (isPercent(x)) return x;\n        return this.length2em(x);\n      });\n    }\n\n    /**\n     * For fixed-width tables, compute the column widths of all columns.\n     *\n     * @param {string[]} swidths   The split and padded columnwidths attribute\n     * @param {number} width       The width of the table\n     * @return {ColumnWidths}      The array of widths\n     */\n    public getColumnWidthsFixed(swidths: string[], width: number): ColumnWidths {\n      //\n      // Get the indices of the fit and auto columns, and the number of fit or auto entries.\n      // If there are fit or auto columns, get the column widths.\n      //\n      const indices = Array.from(swidths.keys());\n      const fit = indices.filter(i => swidths[i] === 'fit');\n      const auto = indices.filter(i => swidths[i] === 'auto');\n      const n = fit.length || auto.length;\n      const {W} = (n ? this.getTableData() : {W: null});\n      //\n      // Determine the space remaining from the fixed width after the\n      //   separation and lines have been removed (cwidth), and\n      //   after the width of the columns have been removed (dw).\n      //\n      const cwidth = width - sum([].concat(this.cLines, this.cSpace)) - 2 * this.fSpace[0];\n      let dw = cwidth;\n      indices.forEach(i => {\n        const x = swidths[i];\n        dw -= (x === 'fit' || x === 'auto' ? W[i] : this.length2em(x, cwidth));\n      });\n      //\n      // Get the amount of extra space per column, or 0 (fw)\n      //\n      const fw = (n && dw > 0 ? dw / n : 0);\n      //\n      // Return the column widths (plus extra space for those that are stretching\n      //\n      return indices.map(i => {\n        const x = swidths[i];\n        if (x === 'fit') return W[i] + fw;\n        if (x === 'auto') return W[i] + (fit.length === 0 ? fw : 0);\n        return this.length2em(x, cwidth);\n      });\n    }\n\n    /**\n     * @param {number} i      The row number (starting at 0)\n     * @param {string} align  The alignment on that row\n     * @return {number}       The offest of the alignment position from the top of the table\n     */\n    public getVerticalPosition(i: number, align: string): number {\n      const equal = this.node.attributes.get('equalrows') as boolean;\n      const {H, D} = this.getTableData();\n      const HD = (equal ? this.getEqualRowHeight() : 0);\n      const space = this.getRowHalfSpacing();\n      //\n      //  Start with frame size and add in spacing, height and depth,\n      //    and line thickness for each row.\n      //\n      let y = this.fLine;\n      for (let j = 0; j < i; j++) {\n        y += space[j] + (equal ? HD : H[j] + D[j]) + space[j + 1] + this.rLines[j];\n      }\n      //\n      //  For equal rows, get updated height and depth\n      //\n      const [h, d] = (equal ? [(HD + H[i] - D[i]) / 2, (HD - H[i] + D[i]) / 2] : [H[i], D[i]]);\n      //\n      //  Add the offset into the specified row\n      //\n      const offset: {[name: string]: number} = {\n        top: 0,\n        center: space[i] + (h + d) / 2,\n        bottom: space[i] + h + d + space[i + 1],\n        baseline: space[i] + h,\n        axis: space[i] + h - .25\n      };\n      y += offset[align] || 0;\n      //\n      //  Return the final result\n      //\n      return y;\n    }\n\n    /******************************************************************/\n\n    /**\n     * @param {number} fspace   The frame spacing to use\n     * @param {number[]} space  The array of spacing values to convert to strings\n     * @param {number} scale    A scaling factor to use for the sizes\n     * @return {string[]}       The half-spacing as stings with units of \"em\"\n     *                           with frame spacing at the beginning and end\n     */\n    public getEmHalfSpacing(fspace: number, space: number[], scale: number = 1): string[] {\n      //\n      //  Get the column spacing values, and add the frame spacing values at the left and right\n      //\n      const fspaceEm = this.em(fspace * scale);\n      const spaceEm = this.addEm(space, 2 / scale);\n      spaceEm.unshift(fspaceEm);\n      spaceEm.push(fspaceEm);\n      return spaceEm;\n    }\n\n    /**\n     * @return {number[]}   The half-spacing for rows with frame spacing at the ends\n     */\n    public getRowHalfSpacing(): number[] {\n      const space = this.rSpace.map(x => x / 2);\n      space.unshift(this.fSpace[1]);\n      space.push(this.fSpace[1]);\n      return space;\n    }\n\n    /**\n     * @return {number[]}   The half-spacing for columns with frame spacing at the ends\n     */\n    public getColumnHalfSpacing(): number[] {\n      const space = this.cSpace.map(x => x / 2);\n      space.unshift(this.fSpace[0]);\n      space.push(this.fSpace[0]);\n      return space;\n    }\n\n    /**\n     * @return {[string,number|null]}  The alignment and row number (based at 0) or null\n     */\n    public getAlignmentRow(): [string, number] {\n      const [align, row] = split(this.node.attributes.get('align') as string);\n      if (row == null) return [align, null];\n      let i = parseInt(row);\n      if (i < 0) i += this.numRows + 1;\n      return [align, i < 1 || i > this.numRows ? null : i - 1];\n    }\n\n    /**\n     * @param {string} name           The name of the attribute to get as an array\n     * @param {number=} i             Return this many fewer than numCols entries\n     * @return {string[]}             The array of values in the given attribute, split at spaces,\n     *                                 padded to the number of table columns (minus 1) by repeating the last entry\n     */\n    public getColumnAttributes(name: string, i: number = 1): string[] | null {\n      const n = this.numCols - i;\n      const columns = this.getAttributeArray(name);\n      if (columns.length === 0) return null;\n      while (columns.length < n) {\n        columns.push(columns[columns.length - 1]);\n      }\n      if (columns.length > n) {\n        columns.splice(n);\n      }\n      return columns;\n    }\n\n    /**\n     * @param {string} name           The name of the attribute to get as an array\n     * @param {number=} i             Return this many fewer than numRows entries\n     * @return {string[]}             The array of values in the given attribute, split at spaces,\n     *                                 padded to the number of table rows (minus 1) by repeating the last entry\n     */\n    public getRowAttributes(name: string, i: number = 1): string[] | null {\n      const n = this.numRows - i;\n      const rows = this.getAttributeArray(name);\n      if (rows.length === 0) return null;\n      while (rows.length < n) {\n        rows.push(rows[rows.length - 1]);\n      }\n      if (rows.length > n) {\n        rows.splice(n);\n      }\n      return rows;\n    }\n\n    /**\n     * @param {string} name           The name of the attribute to get as an array\n     * @return {string[]}             The array of values in the given attribute, split at spaces\n     *                                 (after leading and trailing spaces are removed, and multiple\n     *                                  spaces have been collapsed to one).\n     */\n    public getAttributeArray(name: string): string[] {\n      const value = this.node.attributes.get(name) as string;\n      if (!value) return [this.node.attributes.getDefault(name) as string];\n      return split(value);\n    }\n\n    /**\n     * Adds \"em\" to a list of dimensions, after dividing by n (defaults to 1).\n     *\n     * @param {string[]} list   The array of dimensions (in em's)\n     * @param {nunber=} n       The number to divide each dimension by after converted\n     * @return {string[]}       The array of values with \"em\" added\n     */\n    public addEm(list: number[], n: number = 1): string[] | null {\n      if (!list) return null;\n      return list.map(x => this.em(x / n));\n    }\n\n    /**\n     * Converts an array of dimensions (with arbitrary units) to an array of numbers\n     *   representing the dimensions in units of em's.\n     *\n     * @param {string[]} list   The array of dimensions to be turned into em's\n     * @return {number[]}       The array of values converted to em's\n     */\n    public convertLengths(list: string[]): number[] | null {\n      if (!list) return null;\n      return list.map(x => this.length2em(x));\n    }\n  };\n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}