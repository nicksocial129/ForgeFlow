{"ast":null,"code":"import{useState,useCallback}from'react';import{DataGrid as MUIDataGrid,GridActionsCellItem}from'@mui/x-data-grid';import{IconPlus}from'@tabler/icons';import{Button}from'@mui/material';import DeleteIcon from'@mui/icons-material/Delete';import{cloneDeep}from'lodash';import{formatDataGridRows}from'utils/genericHelper';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const DataGrid=_ref=>{var _formatDataGridRows;let{columns,rows,style,disabled=false,hideFooter=false,onChange}=_ref;const[rowValues,setRowValues]=useState((_formatDataGridRows=formatDataGridRows(rows))!==null&&_formatDataGridRows!==void 0?_formatDataGridRows:[]);const deleteItem=useCallback(id=>()=>{let updatedRows=[];setRowValues(prevRows=>{let allRows=[...cloneDeep(prevRows)];allRows=allRows.filter(row=>row.id!==id);updatedRows=allRows;return allRows;});onChange(JSON.stringify(updatedRows));},// eslint-disable-next-line react-hooks/exhaustive-deps\n[]);const addCols=columns=>{return[...columns,{field:'actions',type:'actions',width:80,getActions:params=>[/*#__PURE__*/_jsx(GridActionsCellItem,{icon:/*#__PURE__*/_jsx(DeleteIcon,{}),label:\"Delete\",onClick:deleteItem(params.id)},'Delete')]}];};const colValues=addCols(columns);const handleProcessRowUpdate=newRow=>{let updatedRows=[];setRowValues(prevRows=>{let allRows=[...cloneDeep(prevRows)];const indexToUpdate=allRows.findIndex(row=>row.id===newRow.id);if(indexToUpdate>=0){allRows[indexToUpdate]={...newRow};}updatedRows=allRows;return allRows;});onChange(JSON.stringify(updatedRows));return newRow;};const getEmptyJsonObj=()=>{const obj={};for(let i=0;i<colValues.length;i+=1){var _colValues$i;obj[(_colValues$i=colValues[i])===null||_colValues$i===void 0?void 0:_colValues$i.field]='';}return obj;};const addNewRow=()=>{setRowValues(prevRows=>{let allRows=[...cloneDeep(prevRows)];const lastRowId=allRows.length?allRows[allRows.length-1].id+1:1;allRows.push({...getEmptyJsonObj(),id:lastRowId});return allRows;});};return/*#__PURE__*/_jsxs(_Fragment,{children:[rowValues&&colValues&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:10,height:210,width:'100%',...style},children:/*#__PURE__*/_jsx(MUIDataGrid,{processRowUpdate:handleProcessRowUpdate,isCellEditable:()=>{return!disabled;},hideFooter:hideFooter,onProcessRowUpdateError:error=>console.error(error),rows:rowValues,columns:colValues})}),!disabled&&/*#__PURE__*/_jsx(Button,{sx:{mt:1},variant:\"outlined\",onClick:addNewRow,startIcon:/*#__PURE__*/_jsx(IconPlus,{}),children:\"Add Item\"})]});};","map":{"version":3,"names":["useState","useCallback","DataGrid","MUIDataGrid","GridActionsCellItem","IconPlus","Button","DeleteIcon","cloneDeep","formatDataGridRows","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","_ref","_formatDataGridRows","columns","rows","style","disabled","hideFooter","onChange","rowValues","setRowValues","deleteItem","id","updatedRows","prevRows","allRows","filter","row","JSON","stringify","addCols","field","type","width","getActions","params","icon","label","onClick","colValues","handleProcessRowUpdate","newRow","indexToUpdate","findIndex","getEmptyJsonObj","obj","i","length","_colValues$i","addNewRow","lastRowId","push","children","marginTop","height","processRowUpdate","isCellEditable","onProcessRowUpdateError","error","console","sx","mt","variant","startIcon"],"sources":["/Users/nickprince/Desktop/Flowise Working Commit/packages/ui/src/ui-component/grid/DataGrid.js"],"sourcesContent":["import PropTypes from 'prop-types'\nimport { useState, useCallback } from 'react'\nimport { DataGrid as MUIDataGrid, GridActionsCellItem } from '@mui/x-data-grid'\nimport { IconPlus } from '@tabler/icons'\nimport { Button } from '@mui/material'\nimport DeleteIcon from '@mui/icons-material/Delete'\nimport { cloneDeep } from 'lodash'\nimport { formatDataGridRows } from 'utils/genericHelper'\n\nexport const DataGrid = ({ columns, rows, style, disabled = false, hideFooter = false, onChange }) => {\n    const [rowValues, setRowValues] = useState(formatDataGridRows(rows) ?? [])\n\n    const deleteItem = useCallback(\n        (id) => () => {\n            let updatedRows = []\n            setRowValues((prevRows) => {\n                let allRows = [...cloneDeep(prevRows)]\n                allRows = allRows.filter((row) => row.id !== id)\n                updatedRows = allRows\n                return allRows\n            })\n            onChange(JSON.stringify(updatedRows))\n        },\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        []\n    )\n\n    const addCols = (columns) => {\n        return [\n            ...columns,\n            {\n                field: 'actions',\n                type: 'actions',\n                width: 80,\n                getActions: (params) => [\n                    <GridActionsCellItem key={'Delete'} icon={<DeleteIcon />} label='Delete' onClick={deleteItem(params.id)} />\n                ]\n            }\n        ]\n    }\n\n    const colValues = addCols(columns)\n\n    const handleProcessRowUpdate = (newRow) => {\n        let updatedRows = []\n        setRowValues((prevRows) => {\n            let allRows = [...cloneDeep(prevRows)]\n            const indexToUpdate = allRows.findIndex((row) => row.id === newRow.id)\n            if (indexToUpdate >= 0) {\n                allRows[indexToUpdate] = { ...newRow }\n            }\n            updatedRows = allRows\n            return allRows\n        })\n        onChange(JSON.stringify(updatedRows))\n        return newRow\n    }\n\n    const getEmptyJsonObj = () => {\n        const obj = {}\n        for (let i = 0; i < colValues.length; i += 1) {\n            obj[colValues[i]?.field] = ''\n        }\n        return obj\n    }\n\n    const addNewRow = () => {\n        setRowValues((prevRows) => {\n            let allRows = [...cloneDeep(prevRows)]\n            const lastRowId = allRows.length ? allRows[allRows.length - 1].id + 1 : 1\n            allRows.push({\n                ...getEmptyJsonObj(),\n                id: lastRowId\n            })\n            return allRows\n        })\n    }\n\n    return (\n        <>\n            {rowValues && colValues && (\n                <div style={{ marginTop: 10, height: 210, width: '100%', ...style }}>\n                    <MUIDataGrid\n                        processRowUpdate={handleProcessRowUpdate}\n                        isCellEditable={() => {\n                            return !disabled\n                        }}\n                        hideFooter={hideFooter}\n                        onProcessRowUpdateError={(error) => console.error(error)}\n                        rows={rowValues}\n                        columns={colValues}\n                    />\n                </div>\n            )}\n            {!disabled && (\n                <Button sx={{ mt: 1 }} variant='outlined' onClick={addNewRow} startIcon={<IconPlus />}>\n                    Add Item\n                </Button>\n            )}\n        </>\n    )\n}\n\nDataGrid.propTypes = {\n    rows: PropTypes.array,\n    columns: PropTypes.array,\n    style: PropTypes.any,\n    disabled: PropTypes.bool,\n    hideFooter: PropTypes.bool,\n    onChange: PropTypes.func\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}