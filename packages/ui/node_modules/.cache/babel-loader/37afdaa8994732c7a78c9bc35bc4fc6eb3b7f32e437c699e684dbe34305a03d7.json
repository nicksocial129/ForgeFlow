{"ast":null,"code":"import{Handle,Position,useUpdateNodeInternals}from'reactflow';import{useEffect,useRef,useState,useContext}from'react';// material-ui\nimport{useTheme,styled}from'@mui/material/styles';import{Box,Typography,Tooltip}from'@mui/material';import{tooltipClasses}from'@mui/material/Tooltip';import{flowContext}from'store/context/ReactFlowContext';import{isValidConnection}from'utils/genericHelper';import{Dropdown}from'ui-component/dropdown/Dropdown';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const CustomWidthTooltip=styled(_ref=>{let{className,...props}=_ref;return/*#__PURE__*/_jsx(Tooltip,{...props,classes:{popper:className}});})({[\"& .\".concat(tooltipClasses.tooltip)]:{maxWidth:500}});// ===========================|| NodeOutputHandler ||=========================== //\nconst NodeOutputHandler=_ref2=>{var _outputAnchor$options,_outputAnchor$options2,_outputAnchor$options3,_outputAnchor$options4,_ref3,_data$outputs$outputA;let{outputAnchor,data,disabled=false}=_ref2;const theme=useTheme();const ref=useRef(null);const updateNodeInternals=useUpdateNodeInternals();const[position,setPosition]=useState(0);const[dropdownValue,setDropdownValue]=useState(null);const{reactFlowInstance}=useContext(flowContext);useEffect(()=>{var _ref$current,_ref$current2;if(ref.current&&(_ref$current=ref.current)!==null&&_ref$current!==void 0&&_ref$current.offsetTop&&(_ref$current2=ref.current)!==null&&_ref$current2!==void 0&&_ref$current2.clientHeight){setTimeout(()=>{var _ref$current3,_ref$current4;setPosition(((_ref$current3=ref.current)===null||_ref$current3===void 0?void 0:_ref$current3.offsetTop)+((_ref$current4=ref.current)===null||_ref$current4===void 0?void 0:_ref$current4.clientHeight)/2);updateNodeInternals(data.id);},0);}},[data.id,ref,updateNodeInternals]);useEffect(()=>{setTimeout(()=>{updateNodeInternals(data.id);},0);},[data.id,position,updateNodeInternals]);useEffect(()=>{if(dropdownValue){setTimeout(()=>{updateNodeInternals(data.id);},0);}},[data.id,dropdownValue,updateNodeInternals]);return/*#__PURE__*/_jsxs(\"div\",{ref:ref,children:[outputAnchor.type!=='options'&&!outputAnchor.options&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CustomWidthTooltip,{placement:\"right\",title:outputAnchor.type,children:/*#__PURE__*/_jsx(Handle,{type:\"source\",position:Position.Right,id:outputAnchor.id,isValidConnection:connection=>isValidConnection(connection,reactFlowInstance),style:{height:10,width:10,backgroundColor:data.selected?theme.palette.primary.main:theme.palette.text.secondary,top:position}},outputAnchor.id)}),/*#__PURE__*/_jsx(Box,{sx:{p:2,textAlign:'end'},children:/*#__PURE__*/_jsx(Typography,{children:outputAnchor.label})})]}),outputAnchor.type==='options'&&outputAnchor.options&&outputAnchor.options.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CustomWidthTooltip,{placement:\"right\",title:(_outputAnchor$options=(_outputAnchor$options2=outputAnchor.options.find(opt=>{var _data$outputs;return opt.name===((_data$outputs=data.outputs)===null||_data$outputs===void 0?void 0:_data$outputs[outputAnchor.name]);}))===null||_outputAnchor$options2===void 0?void 0:_outputAnchor$options2.type)!==null&&_outputAnchor$options!==void 0?_outputAnchor$options:outputAnchor.type,children:/*#__PURE__*/_jsx(Handle,{type:\"source\",position:Position.Right,id:(_outputAnchor$options3=(_outputAnchor$options4=outputAnchor.options.find(opt=>{var _data$outputs2;return opt.name===((_data$outputs2=data.outputs)===null||_data$outputs2===void 0?void 0:_data$outputs2[outputAnchor.name]);}))===null||_outputAnchor$options4===void 0?void 0:_outputAnchor$options4.id)!==null&&_outputAnchor$options3!==void 0?_outputAnchor$options3:'',isValidConnection:connection=>isValidConnection(connection,reactFlowInstance),style:{height:10,width:10,backgroundColor:data.selected?theme.palette.primary.main:theme.palette.text.secondary,top:position}})}),/*#__PURE__*/_jsx(Box,{sx:{p:2,textAlign:'end'},children:/*#__PURE__*/_jsx(Dropdown,{disabled:disabled,disableClearable:true,name:outputAnchor.name,options:outputAnchor.options,onSelect:newValue=>{setDropdownValue(newValue);data.outputs[outputAnchor.name]=newValue;},value:(_ref3=(_data$outputs$outputA=data.outputs[outputAnchor.name])!==null&&_data$outputs$outputA!==void 0?_data$outputs$outputA:outputAnchor.default)!==null&&_ref3!==void 0?_ref3:'choose an option'})})]})]});};export default NodeOutputHandler;","map":{"version":3,"names":["Handle","Position","useUpdateNodeInternals","useEffect","useRef","useState","useContext","useTheme","styled","Box","Typography","Tooltip","tooltipClasses","flowContext","isValidConnection","Dropdown","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","CustomWidthTooltip","_ref","className","props","classes","popper","concat","tooltip","maxWidth","NodeOutputHandler","_ref2","_outputAnchor$options","_outputAnchor$options2","_outputAnchor$options3","_outputAnchor$options4","_ref3","_data$outputs$outputA","outputAnchor","data","disabled","theme","ref","updateNodeInternals","position","setPosition","dropdownValue","setDropdownValue","reactFlowInstance","_ref$current","_ref$current2","current","offsetTop","clientHeight","setTimeout","_ref$current3","_ref$current4","id","children","type","options","placement","title","Right","connection","style","height","width","backgroundColor","selected","palette","primary","main","text","secondary","top","sx","p","textAlign","label","length","find","opt","_data$outputs","name","outputs","_data$outputs2","disableClearable","onSelect","newValue","value","default"],"sources":["/Users/nickprince/Desktop/Flowise Working Commit/packages/ui/src/views/canvas/NodeOutputHandler.js"],"sourcesContent":["import PropTypes from 'prop-types'\nimport { Handle, Position, useUpdateNodeInternals } from 'reactflow'\nimport { useEffect, useRef, useState, useContext } from 'react'\n\n// material-ui\nimport { useTheme, styled } from '@mui/material/styles'\nimport { Box, Typography, Tooltip } from '@mui/material'\nimport { tooltipClasses } from '@mui/material/Tooltip'\nimport { flowContext } from 'store/context/ReactFlowContext'\nimport { isValidConnection } from 'utils/genericHelper'\nimport { Dropdown } from 'ui-component/dropdown/Dropdown'\n\nconst CustomWidthTooltip = styled(({ className, ...props }) => <Tooltip {...props} classes={{ popper: className }} />)({\n    [`& .${tooltipClasses.tooltip}`]: {\n        maxWidth: 500\n    }\n})\n\n// ===========================|| NodeOutputHandler ||=========================== //\n\nconst NodeOutputHandler = ({ outputAnchor, data, disabled = false }) => {\n    const theme = useTheme()\n    const ref = useRef(null)\n    const updateNodeInternals = useUpdateNodeInternals()\n    const [position, setPosition] = useState(0)\n    const [dropdownValue, setDropdownValue] = useState(null)\n    const { reactFlowInstance } = useContext(flowContext)\n\n    useEffect(() => {\n        if (ref.current && ref.current?.offsetTop && ref.current?.clientHeight) {\n            setTimeout(() => {\n                setPosition(ref.current?.offsetTop + ref.current?.clientHeight / 2)\n                updateNodeInternals(data.id)\n            }, 0)\n        }\n    }, [data.id, ref, updateNodeInternals])\n\n    useEffect(() => {\n        setTimeout(() => {\n            updateNodeInternals(data.id)\n        }, 0)\n    }, [data.id, position, updateNodeInternals])\n\n    useEffect(() => {\n        if (dropdownValue) {\n            setTimeout(() => {\n                updateNodeInternals(data.id)\n            }, 0)\n        }\n    }, [data.id, dropdownValue, updateNodeInternals])\n\n    return (\n        <div ref={ref}>\n            {outputAnchor.type !== 'options' && !outputAnchor.options && (\n                <>\n                    <CustomWidthTooltip placement='right' title={outputAnchor.type}>\n                        <Handle\n                            type='source'\n                            position={Position.Right}\n                            key={outputAnchor.id}\n                            id={outputAnchor.id}\n                            isValidConnection={(connection) => isValidConnection(connection, reactFlowInstance)}\n                            style={{\n                                height: 10,\n                                width: 10,\n                                backgroundColor: data.selected ? theme.palette.primary.main : theme.palette.text.secondary,\n                                top: position\n                            }}\n                        />\n                    </CustomWidthTooltip>\n                    <Box sx={{ p: 2, textAlign: 'end' }}>\n                        <Typography>{outputAnchor.label}</Typography>\n                    </Box>\n                </>\n            )}\n            {outputAnchor.type === 'options' && outputAnchor.options && outputAnchor.options.length > 0 && (\n                <>\n                    <CustomWidthTooltip\n                        placement='right'\n                        title={\n                            outputAnchor.options.find((opt) => opt.name === data.outputs?.[outputAnchor.name])?.type ?? outputAnchor.type\n                        }\n                    >\n                        <Handle\n                            type='source'\n                            position={Position.Right}\n                            id={outputAnchor.options.find((opt) => opt.name === data.outputs?.[outputAnchor.name])?.id ?? ''}\n                            isValidConnection={(connection) => isValidConnection(connection, reactFlowInstance)}\n                            style={{\n                                height: 10,\n                                width: 10,\n                                backgroundColor: data.selected ? theme.palette.primary.main : theme.palette.text.secondary,\n                                top: position\n                            }}\n                        />\n                    </CustomWidthTooltip>\n                    <Box sx={{ p: 2, textAlign: 'end' }}>\n                        <Dropdown\n                            disabled={disabled}\n                            disableClearable={true}\n                            name={outputAnchor.name}\n                            options={outputAnchor.options}\n                            onSelect={(newValue) => {\n                                setDropdownValue(newValue)\n                                data.outputs[outputAnchor.name] = newValue\n                            }}\n                            value={data.outputs[outputAnchor.name] ?? outputAnchor.default ?? 'choose an option'}\n                        />\n                    </Box>\n                </>\n            )}\n        </div>\n    )\n}\n\nNodeOutputHandler.propTypes = {\n    outputAnchor: PropTypes.object,\n    data: PropTypes.object,\n    disabled: PropTypes.bool\n}\n\nexport default NodeOutputHandler\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}